<? 
include_once(APPPATH.'/models/Entity.php');

class Rekap extends Entity{ 

	var $query;

	function Rekap()
	{
		$this->Entity(); 
	}

	function selectByParamsBkppRekapGolongan($paramsArray=array(),$limit=-1,$from=-1, $statement='')
	{
		$str = "
				SELECT A.SATKER_ID, A.NAMA, TOTCPNS_11, TOTCPNS_12, TOTCPNS_13
                  , TOTCPNS_21, TOTCPNS_22, TOTCPNS_23
                  , TOTCPNS_31, TOTCPNS_32, TOTCPNS 
                  , TOT_11, TOT_12, TOT_13, TOT_14, TOT_GOL1
                  , TOT_21, TOT_22, TOT_23, TOT_24, TOT_GOL2
                  , TOT_31, TOT_32, TOT_33, TOT_34, TOT_GOL3
                  , TOT_41, TOT_42, TOT_43, TOT_44, TOT_GOL4,  TOT
				FROM
				(                  
						SELECT A.SATKER_ID, A.NAMA, COUNT(TOTCPNS_11.PEGAWAI_ID) AS TOTCPNS_11, COUNT(TOTCPNS_12.PEGAWAI_ID) AS TOTCPNS_12, COUNT(TOTCPNS_13.PEGAWAI_ID) AS TOTCPNS_13
								  , COUNT(TOTCPNS_21.PEGAWAI_ID) AS TOTCPNS_21, COUNT(TOTCPNS_22.PEGAWAI_ID) AS TOTCPNS_22, COUNT(TOTCPNS_23.PEGAWAI_ID) AS TOTCPNS_23
								  , COUNT(TOTCPNS_31.PEGAWAI_ID) AS TOTCPNS_31, COUNT(TOTCPNS_32.PEGAWAI_ID) AS TOTCPNS_32, COUNT(TOTCPNS.PEGAWAI_ID) AS TOTCPNS 
								  , COUNT(TOT_11.PEGAWAI_ID) AS TOT_11, COUNT(TOT_12.PEGAWAI_ID) AS TOT_12, COUNT(TOT_13.PEGAWAI_ID) AS TOT_13, COUNT(TOT_14.PEGAWAI_ID) AS TOT_14, COUNT(TOT_GOL1.PEGAWAI_ID) AS TOT_GOL1
								  , COUNT(TOT_21.PEGAWAI_ID) AS TOT_21, COUNT(TOT_22.PEGAWAI_ID) AS TOT_22, COUNT(TOT_23.PEGAWAI_ID) AS TOT_23, COUNT(TOT_24.PEGAWAI_ID) AS TOT_24, COUNT(TOT_GOL2.PEGAWAI_ID) AS TOT_GOL2
								  , COUNT(TOT_31.PEGAWAI_ID) AS TOT_31, COUNT(TOT_32.PEGAWAI_ID) AS TOT_32, COUNT(TOT_33.PEGAWAI_ID) AS TOT_33, COUNT(TOT_34.PEGAWAI_ID) AS TOT_34, COUNT(TOT_GOL3.PEGAWAI_ID) AS TOT_GOL3
								  , COUNT(TOT_41.PEGAWAI_ID) AS TOT_41, COUNT(TOT_42.PEGAWAI_ID) AS TOT_42, COUNT(TOT_43.PEGAWAI_ID) AS TOT_43, COUNT(TOT_44.PEGAWAI_ID) AS TOT_44, COUNT(TOT_GOL4.PEGAWAI_ID) AS TOT_GOL4,  COUNT(TOT.PEGAWAI_ID) AS TOT  
						FROM SATKER A 
						LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 11 AND X.STATUS_PEGAWAI = 1) TOTCPNS_11 ON TOTCPNS_11.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 12 AND X.STATUS_PEGAWAI = 1) TOTCPNS_12 ON TOTCPNS_12.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 13 AND X.STATUS_PEGAWAI = 1) TOTCPNS_13 ON TOTCPNS_13.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.STATUS_PEGAWAI = 1) TOTCPNS_21 ON TOTCPNS_21.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.STATUS_PEGAWAI = 1) TOTCPNS_22 ON TOTCPNS_22.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.STATUS_PEGAWAI = 1) TOTCPNS_23 ON TOTCPNS_23.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.STATUS_PEGAWAI = 1) TOTCPNS_31 ON TOTCPNS_31.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.STATUS_PEGAWAI = 1) TOTCPNS_32 ON TOTCPNS_32.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 11 AND Y.PANGKAT_ID  <= 32  AND X.STATUS_PEGAWAI = 1) TOTCPNS ON TOTCPNS.PEGAWAI_ID = B.PEGAWAI_ID  
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 11 AND X.STATUS_PEGAWAI = 2) TOT_11 ON TOT_11.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 12 AND X.STATUS_PEGAWAI = 2) TOT_12 ON TOT_12.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 13 AND X.STATUS_PEGAWAI = 2) TOT_13 ON TOT_13.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 14 AND X.STATUS_PEGAWAI = 2) TOT_14 ON TOT_14.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID <= 14 AND X.STATUS_PEGAWAI = 2) TOT_GOL1 ON TOT_GOL1.PEGAWAI_ID = B.PEGAWAI_ID    
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.STATUS_PEGAWAI = 2) TOT_21 ON TOT_21.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.STATUS_PEGAWAI = 2) TOT_22 ON TOT_22.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.STATUS_PEGAWAI = 2) TOT_23 ON TOT_23.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 24 AND X.STATUS_PEGAWAI = 2) TOT_24 ON TOT_24.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 21 AND Y.PANGKAT_ID <=24 AND X.STATUS_PEGAWAI = 2) TOT_GOL2 ON TOT_GOL2.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.STATUS_PEGAWAI = 2) TOT_31 ON TOT_31.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.STATUS_PEGAWAI = 2) TOT_32 ON TOT_32.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 33 AND X.STATUS_PEGAWAI = 2) TOT_33 ON TOT_33.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 34 AND X.STATUS_PEGAWAI = 2) TOT_34 ON TOT_34.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 31 AND Y.PANGKAT_ID <=34  AND X.STATUS_PEGAWAI = 2) TOT_GOL3 ON TOT_GOL3.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 41 AND X.STATUS_PEGAWAI = 2) TOT_41 ON TOT_41.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 42 AND X.STATUS_PEGAWAI = 2) TOT_42 ON TOT_42.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 43 AND X.STATUS_PEGAWAI = 2) TOT_43 ON TOT_43.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 44 AND X.STATUS_PEGAWAI = 2) TOT_44 ON TOT_44.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 41 AND Y.PANGKAT_ID <=44  AND X.STATUS_PEGAWAI = 2) TOT_GOL4 ON TOT_GOL4.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.STATUS_PEGAWAI IN(1, 2)) TOT ON TOT.PEGAWAI_ID = B.PEGAWAI_ID
						WHERE 1=1 AND A.SATKER_ID = '01' AND LENGTH(B.SATKER_ID) <= 4
						GROUP BY A.SATKER_ID, A.NAMA
						UNION ALL
						SELECT A.SATKER_ID, A.NAMA, COUNT(TOTCPNS_11.PEGAWAI_ID) AS TOTCPNS_11, COUNT(TOTCPNS_12.PEGAWAI_ID) AS TOTCPNS_12, COUNT(TOTCPNS_13.PEGAWAI_ID) AS TOTCPNS_13
								  , COUNT(TOTCPNS_21.PEGAWAI_ID) AS TOTCPNS_21, COUNT(TOTCPNS_22.PEGAWAI_ID) AS TOTCPNS_22, COUNT(TOTCPNS_23.PEGAWAI_ID) AS TOTCPNS_23
								  , COUNT(TOTCPNS_31.PEGAWAI_ID) AS TOTCPNS_31, COUNT(TOTCPNS_32.PEGAWAI_ID) AS TOTCPNS_32, COUNT(TOTCPNS.PEGAWAI_ID) AS TOTCPNS 
								  , COUNT(TOT_11.PEGAWAI_ID) AS TOT_11, COUNT(TOT_12.PEGAWAI_ID) AS TOT_12, COUNT(TOT_13.PEGAWAI_ID) AS TOT_13, COUNT(TOT_14.PEGAWAI_ID) AS TOT_14, COUNT(TOT_GOL1.PEGAWAI_ID) AS TOT_GOL1
								  , COUNT(TOT_21.PEGAWAI_ID) AS TOT_21, COUNT(TOT_22.PEGAWAI_ID) AS TOT_22, COUNT(TOT_23.PEGAWAI_ID) AS TOT_23, COUNT(TOT_24.PEGAWAI_ID) AS TOT_24, COUNT(TOT_GOL2.PEGAWAI_ID) AS TOT_GOL2
								  , COUNT(TOT_31.PEGAWAI_ID) AS TOT_31, COUNT(TOT_32.PEGAWAI_ID) AS TOT_32, COUNT(TOT_33.PEGAWAI_ID) AS TOT_33, COUNT(TOT_34.PEGAWAI_ID) AS TOT_34, COUNT(TOT_GOL3.PEGAWAI_ID) AS TOT_GOL3
								  , COUNT(TOT_41.PEGAWAI_ID) AS TOT_41, COUNT(TOT_42.PEGAWAI_ID) AS TOT_42, COUNT(TOT_43.PEGAWAI_ID) AS TOT_43, COUNT(TOT_44.PEGAWAI_ID) AS TOT_44, COUNT(TOT_GOL4.PEGAWAI_ID) AS TOT_GOL4,  COUNT(TOT.PEGAWAI_ID) AS TOT  
						FROM SATKER A 
						LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 11 AND X.STATUS_PEGAWAI = 1) TOTCPNS_11 ON TOTCPNS_11.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 12 AND X.STATUS_PEGAWAI = 1) TOTCPNS_12 ON TOTCPNS_12.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 13 AND X.STATUS_PEGAWAI = 1) TOTCPNS_13 ON TOTCPNS_13.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.STATUS_PEGAWAI = 1) TOTCPNS_21 ON TOTCPNS_21.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.STATUS_PEGAWAI = 1) TOTCPNS_22 ON TOTCPNS_22.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.STATUS_PEGAWAI = 1) TOTCPNS_23 ON TOTCPNS_23.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.STATUS_PEGAWAI = 1) TOTCPNS_31 ON TOTCPNS_31.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.STATUS_PEGAWAI = 1) TOTCPNS_32 ON TOTCPNS_32.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 11 AND Y.PANGKAT_ID  <= 32  AND X.STATUS_PEGAWAI = 1) TOTCPNS ON TOTCPNS.PEGAWAI_ID = B.PEGAWAI_ID  
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 11 AND X.STATUS_PEGAWAI = 2) TOT_11 ON TOT_11.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 12 AND X.STATUS_PEGAWAI = 2) TOT_12 ON TOT_12.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 13 AND X.STATUS_PEGAWAI = 2) TOT_13 ON TOT_13.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 14 AND X.STATUS_PEGAWAI = 2) TOT_14 ON TOT_14.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID <= 14 AND X.STATUS_PEGAWAI = 2) TOT_GOL1 ON TOT_GOL1.PEGAWAI_ID = B.PEGAWAI_ID    
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.STATUS_PEGAWAI = 2) TOT_21 ON TOT_21.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.STATUS_PEGAWAI = 2) TOT_22 ON TOT_22.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.STATUS_PEGAWAI = 2) TOT_23 ON TOT_23.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 24 AND X.STATUS_PEGAWAI = 2) TOT_24 ON TOT_24.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 21 AND Y.PANGKAT_ID <=24 AND X.STATUS_PEGAWAI = 2) TOT_GOL2 ON TOT_GOL2.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.STATUS_PEGAWAI = 2) TOT_31 ON TOT_31.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.STATUS_PEGAWAI = 2) TOT_32 ON TOT_32.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 33 AND X.STATUS_PEGAWAI = 2) TOT_33 ON TOT_33.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 34 AND X.STATUS_PEGAWAI = 2) TOT_34 ON TOT_34.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 31 AND Y.PANGKAT_ID <=34  AND X.STATUS_PEGAWAI = 2) TOT_GOL3 ON TOT_GOL3.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 41 AND X.STATUS_PEGAWAI = 2) TOT_41 ON TOT_41.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 42 AND X.STATUS_PEGAWAI = 2) TOT_42 ON TOT_42.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 43 AND X.STATUS_PEGAWAI = 2) TOT_43 ON TOT_43.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 44 AND X.STATUS_PEGAWAI = 2) TOT_44 ON TOT_44.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 41 AND Y.PANGKAT_ID <=44  AND X.STATUS_PEGAWAI = 2) TOT_GOL4 ON TOT_GOL4.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.STATUS_PEGAWAI IN(1, 2)) TOT ON TOT.PEGAWAI_ID = B.PEGAWAI_ID
						WHERE 1=1 AND B.STATUS_PEGAWAI IN(1, 2) AND A.SATKER_ID IN ('010101','010102','010103','010201','010202','010203','010301','010302','010303','010304')
						GROUP BY A.SATKER_ID, A.NAMA
						UNION ALL
						SELECT A.SATKER_ID, A.NAMA, COUNT(TOTCPNS_11.PEGAWAI_ID) AS TOTCPNS_11, COUNT(TOTCPNS_12.PEGAWAI_ID) AS TOTCPNS_12, COUNT(TOTCPNS_13.PEGAWAI_ID) AS TOTCPNS_13
								  , COUNT(TOTCPNS_21.PEGAWAI_ID) AS TOTCPNS_21, COUNT(TOTCPNS_22.PEGAWAI_ID) AS TOTCPNS_22, COUNT(TOTCPNS_23.PEGAWAI_ID) AS TOTCPNS_23
								  , COUNT(TOTCPNS_31.PEGAWAI_ID) AS TOTCPNS_31, COUNT(TOTCPNS_32.PEGAWAI_ID) AS TOTCPNS_32, COUNT(TOTCPNS.PEGAWAI_ID) AS TOTCPNS 
								  , COUNT(TOT_11.PEGAWAI_ID) AS TOT_11, COUNT(TOT_12.PEGAWAI_ID) AS TOT_12, COUNT(TOT_13.PEGAWAI_ID) AS TOT_13, COUNT(TOT_14.PEGAWAI_ID) AS TOT_14, COUNT(TOT_GOL1.PEGAWAI_ID) AS TOT_GOL1
								  , COUNT(TOT_21.PEGAWAI_ID) AS TOT_21, COUNT(TOT_22.PEGAWAI_ID) AS TOT_22, COUNT(TOT_23.PEGAWAI_ID) AS TOT_23, COUNT(TOT_24.PEGAWAI_ID) AS TOT_24, COUNT(TOT_GOL2.PEGAWAI_ID) AS TOT_GOL2
								  , COUNT(TOT_31.PEGAWAI_ID) AS TOT_31, COUNT(TOT_32.PEGAWAI_ID) AS TOT_32, COUNT(TOT_33.PEGAWAI_ID) AS TOT_33, COUNT(TOT_34.PEGAWAI_ID) AS TOT_34, COUNT(TOT_GOL3.PEGAWAI_ID) AS TOT_GOL3
								  , COUNT(TOT_41.PEGAWAI_ID) AS TOT_41, COUNT(TOT_42.PEGAWAI_ID) AS TOT_42, COUNT(TOT_43.PEGAWAI_ID) AS TOT_43, COUNT(TOT_44.PEGAWAI_ID) AS TOT_44, COUNT(TOT_GOL4.PEGAWAI_ID) AS TOT_GOL4,  COUNT(TOT.PEGAWAI_ID) AS TOT  
						FROM SATKER A 
						LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 11 AND X.STATUS_PEGAWAI = 1) TOTCPNS_11 ON TOTCPNS_11.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 12 AND X.STATUS_PEGAWAI = 1) TOTCPNS_12 ON TOTCPNS_12.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 13 AND X.STATUS_PEGAWAI = 1) TOTCPNS_13 ON TOTCPNS_13.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.STATUS_PEGAWAI = 1) TOTCPNS_21 ON TOTCPNS_21.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.STATUS_PEGAWAI = 1) TOTCPNS_22 ON TOTCPNS_22.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.STATUS_PEGAWAI = 1) TOTCPNS_23 ON TOTCPNS_23.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.STATUS_PEGAWAI = 1) TOTCPNS_31 ON TOTCPNS_31.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.STATUS_PEGAWAI = 1) TOTCPNS_32 ON TOTCPNS_32.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 11 AND Y.PANGKAT_ID  <= 32  AND X.STATUS_PEGAWAI = 1) TOTCPNS ON TOTCPNS.PEGAWAI_ID = B.PEGAWAI_ID  
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 11 AND X.STATUS_PEGAWAI = 2) TOT_11 ON TOT_11.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 12 AND X.STATUS_PEGAWAI = 2) TOT_12 ON TOT_12.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 13 AND X.STATUS_PEGAWAI = 2) TOT_13 ON TOT_13.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 14 AND X.STATUS_PEGAWAI = 2) TOT_14 ON TOT_14.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID <= 14 AND X.STATUS_PEGAWAI = 2) TOT_GOL1 ON TOT_GOL1.PEGAWAI_ID = B.PEGAWAI_ID    
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.STATUS_PEGAWAI = 2) TOT_21 ON TOT_21.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.STATUS_PEGAWAI = 2) TOT_22 ON TOT_22.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.STATUS_PEGAWAI = 2) TOT_23 ON TOT_23.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 24 AND X.STATUS_PEGAWAI = 2) TOT_24 ON TOT_24.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 21 AND Y.PANGKAT_ID <=24 AND X.STATUS_PEGAWAI = 2) TOT_GOL2 ON TOT_GOL2.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.STATUS_PEGAWAI = 2) TOT_31 ON TOT_31.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.STATUS_PEGAWAI = 2) TOT_32 ON TOT_32.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 33 AND X.STATUS_PEGAWAI = 2) TOT_33 ON TOT_33.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 34 AND X.STATUS_PEGAWAI = 2) TOT_34 ON TOT_34.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 31 AND Y.PANGKAT_ID <=34  AND X.STATUS_PEGAWAI = 2) TOT_GOL3 ON TOT_GOL3.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 41 AND X.STATUS_PEGAWAI = 2) TOT_41 ON TOT_41.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 42 AND X.STATUS_PEGAWAI = 2) TOT_42 ON TOT_42.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 43 AND X.STATUS_PEGAWAI = 2) TOT_43 ON TOT_43.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 44 AND X.STATUS_PEGAWAI = 2) TOT_44 ON TOT_44.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 41 AND Y.PANGKAT_ID <=44  AND X.STATUS_PEGAWAI = 2) TOT_GOL4 ON TOT_GOL4.PEGAWAI_ID = B.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.STATUS_PEGAWAI IN(1, 2)) TOT ON TOT.PEGAWAI_ID = B.PEGAWAI_ID
						WHERE 1=1 AND B.STATUS_PEGAWAI IN(1, 2) AND A.SATKER_ID_PARENT = '0' AND A.SATKER_ID NOT IN ('01')           
						GROUP BY A.SATKER_ID, A.NAMA
				) A
				WHERE 1=1
		"; 
		$str .= $statement." ORDER BY A.SATKER_ID ";
		$this->query = $str;
		
		return $this->selectLimit($str,-1,-1); 
    }

    function selectByParamsReportTribulanAll($paramsArray=array(),$limit=-1,$from=-1,$statement_satker='', $statement='')
	{
		$str = "
		   		SELECT  PK.PANGKAT_ID, PK.KODE, COUNT(TOT_ALL.PEGAWAI_ID) TOTAL, COUNT(TOT_L.PEGAWAI_ID) AS TOTAL_LAKI, COUNT(TOT_P.PEGAWAI_ID) AS TOTAL_WANITA, COUNT(TOT_JK.PEGAWAI_ID) AS TOTAL_KELAMIN,
						 COUNT(TOT_SK.PEGAWAI_ID) AS SUDAH_KAWIN, COUNT(TOT_BK.PEGAWAI_ID) AS BELUM_KAWIN, COUNT(TOT_JD.PEGAWAI_ID) AS JANDA, COUNT(TOT_DD.PEGAWAI_ID) AS DUDA,  COUNT(TOT_KW.PEGAWAI_ID)  AS TOTAL_KAWIN,
							 COUNT(TOT_IS.PEGAWAI_ID) AS ISLAM, COUNT(TOT_KR.PEGAWAI_ID) AS KRISTEN, COUNT(TOT_KA.PEGAWAI_ID) AS KATOLIK, COUNT(TOT_HD.PEGAWAI_ID) AS HINDU,  COUNT(TOT_BD.PEGAWAI_ID)  AS BUDHA, COUNT(TOT_AG.PEGAWAI_ID)  AS AGAMA,
						 COUNT(TOT_SD.PEGAWAI_ID) AS SD, COUNT(TOT_SMP.PEGAWAI_ID) AS SMP, COUNT(TOT_SMA.PEGAWAI_ID) AS SMA, COUNT(TOT_D1.PEGAWAI_ID) AS D1, COUNT(TOT_D2.PEGAWAI_ID) AS D2, COUNT(TOT_D3.PEGAWAI_ID) AS D3, COUNT(TOT_D4.PEGAWAI_ID) AS D4, COUNT(TOT_S1.PEGAWAI_ID) AS S1, COUNT(TOT_S2.PEGAWAI_ID) AS S2, COUNT(TOT_S3.PEGAWAI_ID) AS S3, COUNT(TOT_DIK.PEGAWAI_ID) AS SEKOLAH
				FROM PANGKAT PK
					   LEFT JOIN PANGKAT_TERAKHIR B ON PK.PANGKAT_ID = B.PANGKAT_ID ".$statement."
						 LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_ALL ON B.PEGAWAI_ID = TOT_ALL.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.JENIS_KELAMIN = 'L' AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_L ON B.PEGAWAI_ID = TOT_L.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.JENIS_KELAMIN = 'P' AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_P ON B.PEGAWAI_ID = TOT_P.PEGAWAI_ID
						 LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.JENIS_KELAMIN IN( 'L','P') AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_JK ON B.PEGAWAI_ID = TOT_JK.PEGAWAI_ID
						 LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X  WHERE  X.STATUS_KAWIN = 1 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_BK ON B.PEGAWAI_ID = TOT_BK.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X  WHERE  X.STATUS_KAWIN = 2 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_SK ON B.PEGAWAI_ID = TOT_SK.PEGAWAI_ID 
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X  WHERE  X.STATUS_KAWIN = 3 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_JD ON B.PEGAWAI_ID = TOT_JD.PEGAWAI_ID  
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.STATUS_KAWIN = 4 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_DD ON B.PEGAWAI_ID = TOT_DD.PEGAWAI_ID
						 LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.STATUS_KAWIN <=4 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_KW ON B.PEGAWAI_ID = TOT_KW.PEGAWAI_ID        
						  LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID = 1 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_IS ON B.PEGAWAI_ID = TOT_IS.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID = 2 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_KR ON B.PEGAWAI_ID = TOT_KR.PEGAWAI_ID 
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID = 3 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_KA ON B.PEGAWAI_ID = TOT_KA.PEGAWAI_ID  
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID = 4 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_HD ON B.PEGAWAI_ID = TOT_HD.PEGAWAI_ID
						 LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID = 5 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_BD ON B.PEGAWAI_ID = TOT_BD.PEGAWAI_ID   
						  LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID <= 5 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_AG ON B.PEGAWAI_ID = TOT_AG.PEGAWAI_ID 
						  LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR Y LEFT JOIN PEGAWAI X ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  Y.PENDIDIKAN_ID = 1 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_SD ON B.PEGAWAI_ID = TOT_SD.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR Y LEFT JOIN PEGAWAI X ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  Y.PENDIDIKAN_ID = 2 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_SMP ON B.PEGAWAI_ID = TOT_SMP.PEGAWAI_ID 
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR Y LEFT JOIN PEGAWAI X ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  Y.PENDIDIKAN_ID = 4 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_SMA ON B.PEGAWAI_ID = TOT_SMA.PEGAWAI_ID  
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR Y LEFT JOIN PEGAWAI X ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  Y.PENDIDIKAN_ID = 5 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_D1 ON B.PEGAWAI_ID = TOT_D1.PEGAWAI_ID
						 LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR Y LEFT JOIN PEGAWAI X ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  Y.PENDIDIKAN_ID = 6 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_D2 ON B.PEGAWAI_ID = TOT_D2.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR Y LEFT JOIN PEGAWAI X ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  Y.PENDIDIKAN_ID = 7 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_D3 ON B.PEGAWAI_ID = TOT_D3.PEGAWAI_ID 
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR Y LEFT JOIN PEGAWAI X ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  Y.PENDIDIKAN_ID = 13 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_D4 ON B.PEGAWAI_ID = TOT_D4.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR Y LEFT JOIN PEGAWAI X ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  Y.PENDIDIKAN_ID = 9 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_S1 ON B.PEGAWAI_ID = TOT_S1.PEGAWAI_ID
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR Y LEFT JOIN PEGAWAI X ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  Y.PENDIDIKAN_ID = 10 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_S2 ON B.PEGAWAI_ID = TOT_S2.PEGAWAI_ID 
						LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR Y LEFT JOIN PEGAWAI X ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  Y.PENDIDIKAN_ID = 11 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_S3 ON B.PEGAWAI_ID = TOT_S3.PEGAWAI_ID 
						 LEFT JOIN
						(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR Y LEFT JOIN PEGAWAI X ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  Y.PENDIDIKAN_ID <= 13 AND X.STATUS_PEGAWAI = 2 ".$statement_satker.") TOT_DIK ON B.PEGAWAI_ID = TOT_DIK.PEGAWAI_ID 
						WHERE  1=1
				GROUP BY PK.PANGKAT_ID, PK.KODE
				ORDER BY PK.PANGKAT_ID DESC
			 
		"; 
		
		$this->query = $str;
		//echo $str;
		return $this->selectLimit($str,-1,-1); 
    }

    function selectByParamsBkppRekapEselonJabatanKosong($paramsArray=array(),$limit=-1,$from=-1, $statement='')
	{
		$str = "
		  
		SELECT SATKER_ID,
			AMBIL_SATKER_INDUK (SATKER_ID) UNIT_KERJA,
			CASE
			WHEN UPPER (A.NAMA) LIKE 'SEKRETARIAT%'
			THEN
			'SEKRETARIS' || SUBSTR (A.NAMA, 12, LENGTH (A.NAMA))
			WHEN UPPER (A.NAMA) LIKE 'ASISTEN%'
			THEN
			A.NAMA
			WHEN UPPER (A.NAMA) LIKE 'SEKRETARIS%'
			THEN
			A.NAMA
			WHEN UPPER (A.NAMA) LIKE 'KECAMATAN%'
			THEN
			'Camat' || SUBSTR (A.NAMA, 10, LENGTH (A.NAMA))
			WHEN UPPER (A.NAMA) LIKE 'KELURAHAN%'
			THEN
			'Lurah' || SUBSTR (A.NAMA, 10, LENGTH (A.NAMA))
			WHEN UPPER (A.NAMA) LIKE 'BADAN%'
			THEN
			'KEPALA' || SUBSTR (A.NAMA, 6, LENGTH (A.NAMA))
			WHEN UPPER (A.NAMA) LIKE 'DINAS%'
			THEN
			'KEPALA ' || A.NAMA
			WHEN UPPER (A.NAMA) LIKE 'BAGIAN%'
			THEN
			'KEPALA ' || A.NAMA
			WHEN UPPER (A.NAMA) LIKE 'BIDANG%'
			THEN
			'KEPALA ' || A.NAMA
			WHEN UPPER (A.NAMA) LIKE 'SUB%'
			THEN
			'KEPALA ' || A.NAMA
			WHEN UPPER (A.NAMA) LIKE 'SEKSI%'
			THEN
			'KEPALA ' || A.NAMA
			WHEN UPPER (A.NAMA) LIKE 'STAF%'
			THEN
			A.NAMA
			END
			NAMA_JABATAN,
			CASE WHEN ESELON_ID = 21
			THEN 1 ELSE 0 END ESELON21,
			CASE WHEN ESELON_ID = 22
			THEN 1 ELSE 0 END ESELON22,
			CASE WHEN ESELON_ID = 31
			THEN 1 ELSE 0 END ESELON31,
			CASE WHEN ESELON_ID = 32
			THEN 1 ELSE 0 END ESELON32,
			CASE WHEN ESELON_ID = 41
			THEN 1 ELSE 0 END ESELON41,
			CASE WHEN ESELON_ID = 42
			THEN 1 ELSE 0 END ESELON42,
			CASE WHEN ESELON_ID = 51
			THEN 1 ELSE 0 END ESELON51,
			CASE WHEN ESELON_ID = 52
			THEN 1 ELSE 0 END ESELON52

			FROM SATKER A
			WHERE PEGAWAI_ID IS NULL AND ESELON_ID IS NOT NULL AND ESELON_ID <> 99
			ORDER BY SATKER_ID ASC
		"; 
		
		$str .= $statement;
		$this->query = $str;
		
				
		return $this->selectLimit($str,-1,-1); 
    }

    function selectByParamsBkppRekapKelKawinPendaga($paramsArray=array(),$limit=-1,$from=-1,$statement='')
	{
		$str = "
		 SELECT A.SATKER_ID, A.NAMA, COUNT(TOT_L.PEGAWAI_ID) AS TOT_L, COUNT(TOT_P.PEGAWAI_ID) AS TOT_P, COUNT(TOT_JK.PEGAWAI_ID) AS TOT_JK ,
		  COUNT(TOT_SK.PEGAWAI_ID) AS SUDAH_KAWIN, COUNT(TOT_BK.PEGAWAI_ID) AS BELUM_KAWIN, COUNT(TOT_JD.PEGAWAI_ID) AS JANDA, COUNT(TOT_DD.PEGAWAI_ID) AS DUDA,  COUNT(TOT_KW.PEGAWAI_ID)  AS TOTAL_KAWIN,
		  COUNT(TOT_SD.PEGAWAI_ID) AS SD, COUNT(TOT_SMP.PEGAWAI_ID) AS SMP, COUNT(TOT_SMA.PEGAWAI_ID) AS SMA, COUNT(TOT_D1.PEGAWAI_ID) AS D1, COUNT(TOT_D2.PEGAWAI_ID) AS D2, COUNT(TOT_D3.PEGAWAI_ID) AS D3, COUNT(TOT_D4.PEGAWAI_ID) AS D4, COUNT(TOT_S1.PEGAWAI_ID) AS S1, COUNT(TOT_S2.PEGAWAI_ID) AS S2, COUNT(TOT_S3.PEGAWAI_ID) AS S3, COUNT(TOT_DIK.PEGAWAI_ID) AS SEKOLAH,
		   COUNT(TOT_IS.PEGAWAI_ID) AS ISLAM, COUNT(TOT_KR.PEGAWAI_ID) AS KRISTEN, COUNT(TOT_KA.PEGAWAI_ID) AS KATOLIK, COUNT(TOT_HD.PEGAWAI_ID) AS HINDU,  COUNT(TOT_BD.PEGAWAI_ID)  AS BUDHA, COUNT(TOT_KP.PEGAWAI_ID)  AS KP, COUNT(TOT_AG.PEGAWAI_ID)  AS AGAMA  
		FROM SATKER A LEFT JOIN SATKER B ON B.SATKER_ID  LIKE A.SATKER_ID || '%' 
		LEFT JOIN
		(SELECT PEGAWAI_ID FROM PEGAWAI X  WHERE X.JENIS_KELAMIN = 'L' AND X.STATUS_PEGAWAI IN(1, 2) ) TOT_L ON TOT_L.PEGAWAI_ID  = B.PEGAWAI_ID
		LEFT JOIN
		(SELECT PEGAWAI_ID FROM PEGAWAI X  WHERE X.JENIS_KELAMIN = 'P' AND X.STATUS_PEGAWAI IN(1, 2)) TOT_P ON TOT_P.PEGAWAI_ID  = B.PEGAWAI_ID
		LEFT JOIN
		(SELECT PEGAWAI_ID FROM PEGAWAI X  WHERE X.JENIS_KELAMIN IN('L', 'P') AND X.STATUS_PEGAWAI IN(1, 2)) TOT_JK ON TOT_JK.PEGAWAI_ID  = B.PEGAWAI_ID
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X  WHERE  X.STATUS_KAWIN = 1 AND X.STATUS_PEGAWAI IN(1, 2)) TOT_BK ON B.PEGAWAI_ID = TOT_BK.PEGAWAI_ID
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X  WHERE  X.STATUS_KAWIN = 2 AND X.STATUS_PEGAWAI IN(1, 2)) TOT_SK ON B.PEGAWAI_ID = TOT_SK.PEGAWAI_ID 
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X  WHERE  X.STATUS_KAWIN = 3 AND X.STATUS_PEGAWAI IN(1, 2)) TOT_JD ON B.PEGAWAI_ID = TOT_JD.PEGAWAI_ID  
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.STATUS_KAWIN = 4 AND X.STATUS_PEGAWAI IN(1, 2)) TOT_DD ON B.PEGAWAI_ID = TOT_DD.PEGAWAI_ID
		 LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.STATUS_KAWIN IN(1,2,3,4) AND X.STATUS_PEGAWAI IN(1, 2)) TOT_KW ON B.PEGAWAI_ID = TOT_KW.PEGAWAI_ID  
		  LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR X LEFT JOIN PEGAWAI Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  X.PENDIDIKAN_ID = 1 AND Y.STATUS_PEGAWAI IN(1, 2)) TOT_SD ON B.PEGAWAI_ID = TOT_SD.PEGAWAI_ID
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR X LEFT JOIN PEGAWAI Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  X.PENDIDIKAN_ID = 2 AND Y.STATUS_PEGAWAI IN(1, 2)) TOT_SMP ON B.PEGAWAI_ID = TOT_SMP.PEGAWAI_ID 
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR X LEFT JOIN PEGAWAI Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  X.PENDIDIKAN_ID = 4 AND Y.STATUS_PEGAWAI IN(1, 2)) TOT_SMA ON B.PEGAWAI_ID = TOT_SMA.PEGAWAI_ID  
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR X LEFT JOIN PEGAWAI Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  X.PENDIDIKAN_ID = 5 AND Y.STATUS_PEGAWAI IN(1, 2)) TOT_D1 ON B.PEGAWAI_ID = TOT_D1.PEGAWAI_ID
		 LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR X LEFT JOIN PEGAWAI Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  X.PENDIDIKAN_ID = 6 AND Y.STATUS_PEGAWAI IN(1, 2)) TOT_D2 ON B.PEGAWAI_ID = TOT_D2.PEGAWAI_ID
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR X LEFT JOIN PEGAWAI Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  X.PENDIDIKAN_ID = 7 AND Y.STATUS_PEGAWAI IN(1, 2)) TOT_D3 ON B.PEGAWAI_ID = TOT_D3.PEGAWAI_ID 
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR X LEFT JOIN PEGAWAI Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  X.PENDIDIKAN_ID = 13 AND Y.STATUS_PEGAWAI IN(1, 2)) TOT_D4 ON B.PEGAWAI_ID = TOT_D4.PEGAWAI_ID
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR X LEFT JOIN PEGAWAI Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  X.PENDIDIKAN_ID = 9 AND Y.STATUS_PEGAWAI IN(1, 2)) TOT_S1 ON B.PEGAWAI_ID = TOT_S1.PEGAWAI_ID
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR X LEFT JOIN PEGAWAI Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  X.PENDIDIKAN_ID = 10 AND  Y.STATUS_PEGAWAI IN(1, 2)) TOT_S2 ON B.PEGAWAI_ID = TOT_S2.PEGAWAI_ID 
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR X LEFT JOIN PEGAWAI Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  X.PENDIDIKAN_ID = 11 AND  Y.STATUS_PEGAWAI IN(1, 2)) TOT_S3 ON B.PEGAWAI_ID = TOT_S3.PEGAWAI_ID 
		 LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PENDIDIKAN_TERAKHIR X LEFT JOIN PEGAWAI Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE  X.PENDIDIKAN_ID <= 13 AND  Y.STATUS_PEGAWAI IN(1, 2)) TOT_DIK ON B.PEGAWAI_ID = TOT_DIK.PEGAWAI_ID
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID = 1 AND X.STATUS_PEGAWAI IN(1, 2)) TOT_IS ON B.PEGAWAI_ID = TOT_IS.PEGAWAI_ID
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID = 2 AND X.STATUS_PEGAWAI IN(1, 2)) TOT_KR ON B.PEGAWAI_ID = TOT_KR.PEGAWAI_ID 
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID = 3 AND X.STATUS_PEGAWAI IN(1, 2)) TOT_KA ON B.PEGAWAI_ID = TOT_KA.PEGAWAI_ID  
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID = 4 AND X.STATUS_PEGAWAI IN(1, 2)) TOT_HD ON B.PEGAWAI_ID = TOT_HD.PEGAWAI_ID
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID = 5 AND X.STATUS_PEGAWAI IN(1, 2)) TOT_BD ON B.PEGAWAI_ID = TOT_BD.PEGAWAI_ID   
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID IN (6, 7) AND X.STATUS_PEGAWAI IN(1, 2)) TOT_KP ON B.PEGAWAI_ID = TOT_KP.PEGAWAI_ID  
		LEFT JOIN
		(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE  X.AGAMA_ID <= 7 AND X.STATUS_PEGAWAI IN(1, 2)) TOT_AG ON B.PEGAWAI_ID = TOT_AG.PEGAWAI_ID
		WHERE  A.SATKER_ID_PARENT = '0' 
		GROUP BY A.SATKER_ID, A.NAMA
		ORDER BY A.SATKER_ID ASC
		"; 
		// OR A.SATKER_ID_PARENT LIKE '01%' AND LENGTH(A.SATKER_ID_PARENT) <= 6  AND A.NAMA NOT LIKE 'ASISTEN%'   AND A.NAMA NOT LIKE 'SUB%' AND A.NAMA NOT LIKE 'STAF%'  
		$str .= $statement;
		$this->query = $str;
		
				
		return $this->selectLimit($str,-1,-1); 
    }
	
	function selectByParamsBkppRekapEselon($paramsArray=array(),$limit=-1,$from=-1,$statement='')
	{
		$str = "
	   	SELECT A.SATKER_ID, A.NAMA, TOT21_43,  TOT22_41,  TOT22_42,  TOT22_43, TOT22_44, TOT2
                        , TOT31_34, TOT31_41, TOT31_42, TOT32_33, TOT32_34, TOT32_41, TOT32_42, TOT3
                        , TOT41_32, TOT41_33, TOT41_34, TOT41_41, TOT41_42, TOT42_31, TOT42_32, TOT42_33, TOT42_34, TOT4
                        , TOT51_31, TOT51_32, TOT51_33, TOT51_34, TOT52_31, TOT52_32, TOT52_33, TOT52_34, TOT5
                        , TOT
		FROM
		(
			SELECT A.SATKER_ID, A.NAMA, COUNT(TOT21_43.PEGAWAI_ID) AS TOT21_43,  COUNT(TOT22_41.PEGAWAI_ID) AS TOT22_41,  COUNT(TOT22_42.PEGAWAI_ID) AS TOT22_42,  COUNT(TOT22_43.PEGAWAI_ID) AS TOT22_43, COUNT(TOT22_44.PEGAWAI_ID) AS TOT22_44, COUNT(TOT2.PEGAWAI_ID) AS TOT2
                        , COUNT(TOT31_34.PEGAWAI_ID) AS TOT31_34, COUNT(TOT31_41.PEGAWAI_ID) AS TOT31_41, COUNT(TOT31_42.PEGAWAI_ID) AS TOT31_42, COUNT(TOT32_33.PEGAWAI_ID) AS TOT32_33, COUNT(TOT32_34.PEGAWAI_ID) AS TOT32_34, COUNT(TOT32_41.PEGAWAI_ID) AS TOT32_41, COUNT(TOT32_42.PEGAWAI_ID) AS TOT32_42,  COUNT(TOT3.PEGAWAI_ID) AS TOT3
                        , COUNT(TOT41_32.PEGAWAI_ID) AS TOT41_32, COUNT(TOT41_33.PEGAWAI_ID) AS TOT41_33, COUNT(TOT41_34.PEGAWAI_ID) AS TOT41_34, COUNT(TOT41_41.PEGAWAI_ID) AS TOT41_41, COUNT(TOT41_42.PEGAWAI_ID) AS TOT41_42, COUNT(TOT42_31.PEGAWAI_ID) AS TOT42_31, COUNT(TOT42_32.PEGAWAI_ID) AS TOT42_32, COUNT(TOT42_33.PEGAWAI_ID) AS TOT42_33, COUNT(TOT42_34.PEGAWAI_ID) AS TOT42_34,    COUNT(TOT4.PEGAWAI_ID) AS TOT4
                        , COUNT(TOT51_31.PEGAWAI_ID) AS TOT51_31, COUNT(TOT51_32.PEGAWAI_ID) AS TOT51_32, COUNT(TOT51_33.PEGAWAI_ID) AS TOT51_33, COUNT(TOT51_34.PEGAWAI_ID) AS TOT51_34, COUNT(TOT52_31.PEGAWAI_ID) AS TOT52_31, COUNT(TOT52_32.PEGAWAI_ID) AS TOT52_32, COUNT(TOT52_33.PEGAWAI_ID) AS TOT52_33, COUNT(TOT52_34.PEGAWAI_ID) AS TOT52_34,    COUNT(TOT5.PEGAWAI_ID) AS TOT5
                        , COUNT(TOT.PEGAWAI_ID) AS TOT
                        FROM SATKER A
                        LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
                        LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 43
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint::bigint AND JT.ESELON_ID = 21
                        ) TOT21_43 ON TOT21_43.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_41 ON TOT22_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_42 ON TOT22_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 43
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_43 ON TOT22_43.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 44
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_44 ON TOT22_44.PEGAWAI_ID  = B.PEGAWAI_ID
                        LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 41 AND PT.PANGKAT_ID <= 44
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID < 23
                        ) TOT2 ON TOT2.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 31
                        ) TOT31_34 ON TOT31_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 31
                        ) TOT31_41 ON TOT31_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 31
                        ) TOT31_42 ON TOT31_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_33 ON TOT32_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_34 ON TOT32_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_41 ON TOT32_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_42 ON TOT32_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 33 AND PT.PANGKAT_ID <= 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID < 32
                        ) TOT3 ON TOT3.PEGAWAI_ID  = B.PEGAWAI_ID
                                    LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_32 ON TOT41_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_33 ON TOT41_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_34 ON TOT41_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_41 ON TOT41_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_42 ON TOT41_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 31
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_31 ON TOT42_31.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_32 ON TOT42_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_33 ON TOT42_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_34 ON TOT42_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 31 AND PT.PANGKAT_ID <= 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID >=41 AND JT.ESELON_ID <= 42
                        ) TOT4 ON TOT4.PEGAWAI_ID  = B.PEGAWAI_ID
                                    LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 31
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_31 ON TOT51_31.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_32 ON TOT51_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_33 ON TOT51_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_34 ON TOT51_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 31
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_31 ON TOT52_31.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_32 ON TOT52_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_33 ON TOT52_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_34 ON TOT52_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 31 AND PT.PANGKAT_ID <= 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID >=51 AND JT.ESELON_ID <= 52
                        ) TOT5 ON TOT5.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 31 AND PT.PANGKAT_ID <= 44
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID >=21 AND JT.ESELON_ID <= 52
                        ) TOT ON TOT.PEGAWAI_ID  = B.PEGAWAI_ID
                        WHERE 1=1 AND B.STATUS_PEGAWAI IN(1, 2) AND A.SATKER_ID = '01' AND LENGTH(B.SATKER_ID) <= 4
                        GROUP BY A.SATKER_ID, A.NAMA
            UNION ALL
            SELECT A.SATKER_ID, A.NAMA, COUNT(TOT21_43.PEGAWAI_ID) AS TOT21_43,  COUNT(TOT22_41.PEGAWAI_ID) AS TOT22_41,  COUNT(TOT22_42.PEGAWAI_ID) AS TOT22_42,  COUNT(TOT22_43.PEGAWAI_ID) AS TOT22_43, COUNT(TOT22_44.PEGAWAI_ID) AS TOT22_44, COUNT(TOT2.PEGAWAI_ID) AS TOT2
                        , COUNT(TOT31_34.PEGAWAI_ID) AS TOT31_34, COUNT(TOT31_41.PEGAWAI_ID) AS TOT31_41, COUNT(TOT31_42.PEGAWAI_ID) AS TOT31_42, COUNT(TOT32_33.PEGAWAI_ID) AS TOT32_33, COUNT(TOT32_34.PEGAWAI_ID) AS TOT32_34, COUNT(TOT32_41.PEGAWAI_ID) AS TOT32_41, COUNT(TOT32_42.PEGAWAI_ID) AS TOT32_42,  COUNT(TOT3.PEGAWAI_ID) AS TOT3
                        , COUNT(TOT41_32.PEGAWAI_ID) AS TOT41_32, COUNT(TOT41_33.PEGAWAI_ID) AS TOT41_33, COUNT(TOT41_34.PEGAWAI_ID) AS TOT41_34, COUNT(TOT41_41.PEGAWAI_ID) AS TOT41_41, COUNT(TOT41_42.PEGAWAI_ID) AS TOT41_42, COUNT(TOT42_31.PEGAWAI_ID) AS TOT42_31, COUNT(TOT42_32.PEGAWAI_ID) AS TOT42_32, COUNT(TOT42_33.PEGAWAI_ID) AS TOT42_33, COUNT(TOT42_34.PEGAWAI_ID) AS TOT42_34,    COUNT(TOT4.PEGAWAI_ID) AS TOT4
                        , COUNT(TOT51_31.PEGAWAI_ID) AS TOT51_31, COUNT(TOT51_32.PEGAWAI_ID) AS TOT51_32, COUNT(TOT51_33.PEGAWAI_ID) AS TOT51_33, COUNT(TOT51_34.PEGAWAI_ID) AS TOT51_34, COUNT(TOT52_31.PEGAWAI_ID) AS TOT52_31, COUNT(TOT52_32.PEGAWAI_ID) AS TOT52_32, COUNT(TOT52_33.PEGAWAI_ID) AS TOT52_33, COUNT(TOT52_34.PEGAWAI_ID) AS TOT52_34,    COUNT(TOT5.PEGAWAI_ID) AS TOT5
                        , COUNT(TOT.PEGAWAI_ID) AS TOT
                        FROM SATKER A
                        LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
                        LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 43
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 21
                        ) TOT21_43 ON TOT21_43.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_41 ON TOT22_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_42 ON TOT22_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 43
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_43 ON TOT22_43.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 44
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_44 ON TOT22_44.PEGAWAI_ID  = B.PEGAWAI_ID
                        LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 41 AND PT.PANGKAT_ID <= 44
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID < 23
                        ) TOT2 ON TOT2.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 31
                        ) TOT31_34 ON TOT31_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 31
                        ) TOT31_41 ON TOT31_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 31
                        ) TOT31_42 ON TOT31_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_33 ON TOT32_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_34 ON TOT32_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_41 ON TOT32_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_42 ON TOT32_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 33 AND PT.PANGKAT_ID <= 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID < 32
                        ) TOT3 ON TOT3.PEGAWAI_ID  = B.PEGAWAI_ID
                                    LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_32 ON TOT41_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_33 ON TOT41_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_34 ON TOT41_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_41 ON TOT41_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_42 ON TOT41_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 31
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_31 ON TOT42_31.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_32 ON TOT42_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_33 ON TOT42_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_34 ON TOT42_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 31 AND PT.PANGKAT_ID <= 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID >=41 AND JT.ESELON_ID <= 42
                        ) TOT4 ON TOT4.PEGAWAI_ID  = B.PEGAWAI_ID
                                    LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 31
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_31 ON TOT51_31.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_32 ON TOT51_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_33 ON TOT51_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_34 ON TOT51_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 31
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_31 ON TOT52_31.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_32 ON TOT52_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_33 ON TOT52_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_34 ON TOT52_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 31 AND PT.PANGKAT_ID <= 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID >=51 AND JT.ESELON_ID <= 52
                        ) TOT5 ON TOT5.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 31 AND PT.PANGKAT_ID <= 44
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID >=21 AND JT.ESELON_ID <= 52
                        ) TOT ON TOT.PEGAWAI_ID  = B.PEGAWAI_ID
                        WHERE 1=1 AND B.STATUS_PEGAWAI IN(1, 2) AND A.SATKER_ID IN ('010101','010102','010103','010201','010202','010203','010301','010302','010303','010304')
                        GROUP BY A.SATKER_ID, A.NAMA
            UNION ALL
            SELECT A.SATKER_ID, A.NAMA, COUNT(TOT21_43.PEGAWAI_ID) AS TOT21_43,  COUNT(TOT22_41.PEGAWAI_ID) AS TOT22_41,  COUNT(TOT22_42.PEGAWAI_ID) AS TOT22_42,  COUNT(TOT22_43.PEGAWAI_ID) AS TOT22_43, COUNT(TOT22_44.PEGAWAI_ID) AS TOT22_44, COUNT(TOT2.PEGAWAI_ID) AS TOT2
                        , COUNT(TOT31_34.PEGAWAI_ID) AS TOT31_34, COUNT(TOT31_41.PEGAWAI_ID) AS TOT31_41, COUNT(TOT31_42.PEGAWAI_ID) AS TOT31_42, COUNT(TOT32_33.PEGAWAI_ID) AS TOT32_33, COUNT(TOT32_34.PEGAWAI_ID) AS TOT32_34, COUNT(TOT32_41.PEGAWAI_ID) AS TOT32_41, COUNT(TOT32_42.PEGAWAI_ID) AS TOT32_42,  COUNT(TOT3.PEGAWAI_ID) AS TOT3
                        , COUNT(TOT41_32.PEGAWAI_ID) AS TOT41_32, COUNT(TOT41_33.PEGAWAI_ID) AS TOT41_33, COUNT(TOT41_34.PEGAWAI_ID) AS TOT41_34, COUNT(TOT41_41.PEGAWAI_ID) AS TOT41_41, COUNT(TOT41_42.PEGAWAI_ID) AS TOT41_42, COUNT(TOT42_31.PEGAWAI_ID) AS TOT42_31, COUNT(TOT42_32.PEGAWAI_ID) AS TOT42_32, COUNT(TOT42_33.PEGAWAI_ID) AS TOT42_33, COUNT(TOT42_34.PEGAWAI_ID) AS TOT42_34,    COUNT(TOT4.PEGAWAI_ID) AS TOT4
                        , COUNT(TOT51_31.PEGAWAI_ID) AS TOT51_31, COUNT(TOT51_32.PEGAWAI_ID) AS TOT51_32, COUNT(TOT51_33.PEGAWAI_ID) AS TOT51_33, COUNT(TOT51_34.PEGAWAI_ID) AS TOT51_34, COUNT(TOT52_31.PEGAWAI_ID) AS TOT52_31, COUNT(TOT52_32.PEGAWAI_ID) AS TOT52_32, COUNT(TOT52_33.PEGAWAI_ID) AS TOT52_33, COUNT(TOT52_34.PEGAWAI_ID) AS TOT52_34,    COUNT(TOT5.PEGAWAI_ID) AS TOT5
                        , COUNT(TOT.PEGAWAI_ID) AS TOT
                        FROM SATKER A
                        LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
                        LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 43
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 21
                        ) TOT21_43 ON TOT21_43.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_41 ON TOT22_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_42 ON TOT22_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 43
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_43 ON TOT22_43.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 44
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 22
                        ) TOT22_44 ON TOT22_44.PEGAWAI_ID  = B.PEGAWAI_ID
                        LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 41 AND PT.PANGKAT_ID <= 44
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID < 23
                        ) TOT2 ON TOT2.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 31
                        ) TOT31_34 ON TOT31_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 31
                        ) TOT31_41 ON TOT31_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 31
                        ) TOT31_42 ON TOT31_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_33 ON TOT32_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_34 ON TOT32_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_41 ON TOT32_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 32
                        ) TOT32_42 ON TOT32_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 33 AND PT.PANGKAT_ID <= 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID >=31 AND JT.ESELON_ID <= 32
                        ) TOT3 ON TOT3.PEGAWAI_ID  = B.PEGAWAI_ID
                                    LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_32 ON TOT41_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_33 ON TOT41_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_34 ON TOT41_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 41
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_41 ON TOT41_41.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 41
                        ) TOT41_42 ON TOT41_42.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 31
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_31 ON TOT42_31.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_32 ON TOT42_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_33 ON TOT42_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 42
                        ) TOT42_34 ON TOT42_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 31 AND PT.PANGKAT_ID <= 42
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID >=41 AND JT.ESELON_ID <= 42
                        ) TOT4 ON TOT4.PEGAWAI_ID  = B.PEGAWAI_ID
                                    LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 31
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_31 ON TOT51_31.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_32 ON TOT51_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_33 ON TOT51_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 51
                        ) TOT51_34 ON TOT51_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 31
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_31 ON TOT52_31.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 32
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_32 ON TOT52_32.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 33
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_33 ON TOT52_33.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID = 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID = 52
                        ) TOT52_34 ON TOT52_34.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 31 AND PT.PANGKAT_ID <= 34
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID >=51 AND JT.ESELON_ID <= 52
                        ) TOT5 ON TOT5.PEGAWAI_ID  = B.PEGAWAI_ID
            LEFT JOIN
                        (
                        SELECT P.PEGAWAI_ID FROM SATKER X INNER JOIN PEGAWAI P ON X.SATKER_ID = P.SATKER_ID INNER JOIN PANGKAT_TERAKHIR PT ON P.PEGAWAI_ID = PT.PEGAWAI_ID AND PT.PANGKAT_ID >= 31 AND PT.PANGKAT_ID <= 44
                        INNER JOIN JABATAN_TERAKHIR JT ON P.PEGAWAI_ID = JT.PEGAWAI_ID::bigint AND JT.ESELON_ID >=21 AND JT.ESELON_ID <= 52
                        ) TOT ON TOT.PEGAWAI_ID  = B.PEGAWAI_ID
                        WHERE 1=1 AND B.STATUS_PEGAWAI IN(1, 2) AND A.SATKER_ID_PARENT = '0' AND A.SATKER_ID NOT IN ('01')            
                        GROUP BY A.SATKER_ID, A.NAMA
		) A
		WHERE 1=1
		"; 
		$str .= $statement." ORDER BY A.SATKER_ID";
		$this->query = $str;
				
		return $this->selectLimit($str,-1,-1); 
    }

    function selectByParamsBkppRekapFungsionalStaf($paramsArray=array(),$limit=-1,$from=-1,$statement='')
	{
		$str = "
		SELECT A.SATKER_ID, A.NAMA, TOT_21, TOT_22, TOT_23, TOT_24, TOT_GOL2
					  , TOT_31, TOT_32, TOT_33, TOT_34, TOT_GOL3
					  , TOT_41, TOT_42, TOT_43, TOT_44, TOT_GOL4, TOT 
					  , TOT_11_STAF, TOT_12_STAF, TOT_13_STAF, TOT_14_STAF, TOT_STAF1        
					  , TOT_21_STAF, TOT_22_STAF, TOT_23_STAF, TOT_24_STAF, TOT_STAF2
					  , TOT_31_STAF, TOT_32_STAF, TOT_33_STAF, TOT_34_STAF, TOT_STAF3
					  , TOT_41_STAF, TOT_42_STAF, TOT_43_STAF, TOT_44_STAF, TOT_STAF4, TOT_STAF
			FROM
			(
						SELECT A.SATKER_ID, A.NAMA, COUNT(TOT_21.PEGAWAI_ID) AS TOT_21, COUNT(TOT_22.PEGAWAI_ID) AS TOT_22, COUNT(TOT_23.PEGAWAI_ID) AS TOT_23, COUNT(TOT_24.PEGAWAI_ID) AS TOT_24, COUNT(TOT_GOL2.PEGAWAI_ID) AS TOT_GOL2
					  , COUNT(TOT_31.PEGAWAI_ID) AS TOT_31, COUNT(TOT_32.PEGAWAI_ID) AS TOT_32, COUNT(TOT_33.PEGAWAI_ID) AS TOT_33, COUNT(TOT_34.PEGAWAI_ID) AS TOT_34, COUNT(TOT_GOL3.PEGAWAI_ID) AS TOT_GOL3
					  , COUNT(TOT_41.PEGAWAI_ID) AS TOT_41, COUNT(TOT_42.PEGAWAI_ID) AS TOT_42, COUNT(TOT_43.PEGAWAI_ID) AS TOT_43, COUNT(TOT_44.PEGAWAI_ID) AS TOT_44, COUNT(TOT_GOL4.PEGAWAI_ID) AS TOT_GOL4,  COUNT(TOT.PEGAWAI_ID) AS TOT 
					  , COUNT(TOT_11_STAF.PEGAWAI_ID) AS TOT_11_STAF, COUNT(TOT_12_STAF.PEGAWAI_ID) AS TOT_12_STAF, COUNT(TOT_13_STAF.PEGAWAI_ID) AS TOT_13_STAF, COUNT(TOT_14_STAF.PEGAWAI_ID) AS TOT_14_STAF, COUNT(TOT_STAF1.PEGAWAI_ID) AS TOT_STAF1        
					  , COUNT(TOT_21_STAF.PEGAWAI_ID) AS TOT_21_STAF, COUNT(TOT_22_STAF.PEGAWAI_ID) AS TOT_22_STAF, COUNT(TOT_23_STAF.PEGAWAI_ID) AS TOT_23_STAF, COUNT(TOT_24_STAF.PEGAWAI_ID) AS TOT_24_STAF, COUNT(TOT_STAF2.PEGAWAI_ID) AS TOT_STAF2
					  , COUNT(TOT_31_STAF.PEGAWAI_ID) AS TOT_31_STAF, COUNT(TOT_32_STAF.PEGAWAI_ID) AS TOT_32_STAF, COUNT(TOT_33_STAF.PEGAWAI_ID) AS TOT_33_STAF, COUNT(TOT_34_STAF.PEGAWAI_ID) AS TOT_34_STAF, COUNT(TOT_STAF3.PEGAWAI_ID) AS TOT_STAF3
					  , COUNT(TOT_41_STAF.PEGAWAI_ID) AS TOT_41_STAF, COUNT(TOT_42_STAF.PEGAWAI_ID) AS TOT_42_STAF, COUNT(TOT_43_STAF.PEGAWAI_ID) AS TOT_43_STAF, COUNT(TOT_44_STAF.PEGAWAI_ID) AS TOT_44_STAF, COUNT(TOT_STAF4.PEGAWAI_ID) AS TOT_STAF4,  COUNT(TOT_STAF.PEGAWAI_ID) AS TOT_STAF
						FROM SATKER A
                        LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_21 
                        ON TOT_21.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_22 
                        ON TOT_22.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.TIPE_PEGAWAI_ID LIKE '2%' ) TOT_23 
                        ON TOT_23.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 24 AND X.TIPE_PEGAWAI_ID LIKE '2%' ) TOT_24 
                        ON TOT_24.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 21 AND Y.PANGKAT_ID <=24  AND X.TIPE_PEGAWAI_ID LIKE '2%' ) TOT_GOL2 
                        ON TOT_GOL2.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_31 
                        ON TOT_31.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_32 
                        ON TOT_32.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 33 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_33 
                        ON TOT_33.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 34 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_34 
                        ON TOT_34.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 31 AND Y.PANGKAT_ID <=34  AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_GOL3 
                        ON TOT_GOL3.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 41 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_41 
                        ON TOT_41.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 42 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_42 
                        ON TOT_42.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE Y.PANGKAT_ID = 43 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_43 
                        ON TOT_43.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 44 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_44 
                        ON TOT_44.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 41 AND Y.PANGKAT_ID <=45  AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_GOL4 
                        ON TOT_GOL4.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X  LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE  X.TIPE_PEGAWAI_ID LIKE '2%') TOT 
                        ON TOT.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 11 AND X.TIPE_PEGAWAI_ID ='12') TOT_11_STAF 
                        ON TOT_11_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 12 AND X.TIPE_PEGAWAI_ID ='12') TOT_12_STAF 
                        ON TOT_12_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 13 AND X.TIPE_PEGAWAI_ID ='12') TOT_13_STAF 
                        ON TOT_13_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                         LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 14 AND X.TIPE_PEGAWAI_ID ='12') TOT_14_STAF 
                        ON TOT_14_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 11 AND Y.PANGKAT_ID <=14  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF1 
                        ON TOT_STAF1.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.TIPE_PEGAWAI_ID ='12') TOT_21_STAF 
                        ON TOT_21_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.TIPE_PEGAWAI_ID ='12') TOT_22_STAF  
                        ON TOT_22_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.TIPE_PEGAWAI_ID ='12') TOT_23_STAF  
                        ON TOT_23_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                         LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 24 AND X.TIPE_PEGAWAI_ID ='12') TOT_24_STAF  
                        ON TOT_24_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 21 AND Y.PANGKAT_ID <=24  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF2 
                        ON TOT_STAF2.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.TIPE_PEGAWAI_ID ='12') TOT_31_STAF  
                        ON TOT_31_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.TIPE_PEGAWAI_ID ='12') TOT_32_STAF  
                        ON TOT_32_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 33 AND X.TIPE_PEGAWAI_ID ='12') TOT_33_STAF  
                        ON TOT_33_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 34 AND X.TIPE_PEGAWAI_ID ='12') TOT_34_STAF  
                        ON TOT_34_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 31 AND Y.PANGKAT_ID <=34  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF3 
                        ON TOT_STAF3.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 41 AND X.TIPE_PEGAWAI_ID = '12') TOT_41_STAF 
                        ON TOT_41_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 42 AND X.TIPE_PEGAWAI_ID ='12') TOT_42_STAF 
                        ON TOT_42_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 43 AND X.TIPE_PEGAWAI_ID ='12') TOT_43_STAF 
                        ON TOT_43_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 44 AND X.TIPE_PEGAWAI_ID = '12') TOT_44_STAF 
                        ON TOT_44_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 41 AND Y.PANGKAT_ID <=45  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF4 
                        ON TOT_STAF4.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X  LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE  X.TIPE_PEGAWAI_ID = '12') TOT_STAF 
                        ON TOT_STAF.PEGAWAI_ID = B.PEGAWAI_ID
						WHERE 1=1 AND B.STATUS_PEGAWAI IN(1, 2) AND A.SATKER_ID = '01' AND LENGTH(B.SATKER_ID) <= 4
					GROUP BY A.SATKER_ID, A.NAMA
			UNION ALL
			SELECT A.SATKER_ID, A.NAMA, COUNT(TOT_21.PEGAWAI_ID) AS TOT_21, COUNT(TOT_22.PEGAWAI_ID) AS TOT_22, COUNT(TOT_23.PEGAWAI_ID) AS TOT_23, COUNT(TOT_24.PEGAWAI_ID) AS TOT_24, COUNT(TOT_GOL2.PEGAWAI_ID) AS TOT_GOL2
					  , COUNT(TOT_31.PEGAWAI_ID) AS TOT_31, COUNT(TOT_32.PEGAWAI_ID) AS TOT_32, COUNT(TOT_33.PEGAWAI_ID) AS TOT_33, COUNT(TOT_34.PEGAWAI_ID) AS TOT_34, COUNT(TOT_GOL3.PEGAWAI_ID) AS TOT_GOL3
					  , COUNT(TOT_41.PEGAWAI_ID) AS TOT_41, COUNT(TOT_42.PEGAWAI_ID) AS TOT_42, COUNT(TOT_43.PEGAWAI_ID) AS TOT_43, COUNT(TOT_44.PEGAWAI_ID) AS TOT_44, COUNT(TOT_GOL4.PEGAWAI_ID) AS TOT_GOL4,  COUNT(TOT.PEGAWAI_ID) AS TOT 
					  , COUNT(TOT_11_STAF.PEGAWAI_ID) AS TOT_11_STAF, COUNT(TOT_12_STAF.PEGAWAI_ID) AS TOT_12_STAF, COUNT(TOT_13_STAF.PEGAWAI_ID) AS TOT_13_STAF, COUNT(TOT_14_STAF.PEGAWAI_ID) AS TOT_14_STAF, COUNT(TOT_STAF1.PEGAWAI_ID) AS TOT_STAF1        
					  , COUNT(TOT_21_STAF.PEGAWAI_ID) AS TOT_21_STAF, COUNT(TOT_22_STAF.PEGAWAI_ID) AS TOT_22_STAF, COUNT(TOT_23_STAF.PEGAWAI_ID) AS TOT_23_STAF, COUNT(TOT_24_STAF.PEGAWAI_ID) AS TOT_24_STAF, COUNT(TOT_STAF2.PEGAWAI_ID) AS TOT_STAF2
					  , COUNT(TOT_31_STAF.PEGAWAI_ID) AS TOT_31_STAF, COUNT(TOT_32_STAF.PEGAWAI_ID) AS TOT_32_STAF, COUNT(TOT_33_STAF.PEGAWAI_ID) AS TOT_33_STAF, COUNT(TOT_34_STAF.PEGAWAI_ID) AS TOT_34_STAF, COUNT(TOT_STAF3.PEGAWAI_ID) AS TOT_STAF3
					  , COUNT(TOT_41_STAF.PEGAWAI_ID) AS TOT_41_STAF, COUNT(TOT_42_STAF.PEGAWAI_ID) AS TOT_42_STAF, COUNT(TOT_43_STAF.PEGAWAI_ID) AS TOT_43_STAF, COUNT(TOT_44_STAF.PEGAWAI_ID) AS TOT_44_STAF, COUNT(TOT_STAF4.PEGAWAI_ID) AS TOT_STAF4,  COUNT(TOT_STAF.PEGAWAI_ID) AS TOT_STAF
						FROM SATKER A
                        LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_21 
                        ON TOT_21.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_22 
                        ON TOT_22.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.TIPE_PEGAWAI_ID LIKE '2%' ) TOT_23 
                        ON TOT_23.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 24 AND X.TIPE_PEGAWAI_ID LIKE '2%' ) TOT_24 
                        ON TOT_24.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 21 AND Y.PANGKAT_ID <=24  AND X.TIPE_PEGAWAI_ID LIKE '2%' ) TOT_GOL2 
                        ON TOT_GOL2.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_31 
                        ON TOT_31.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_32 
                        ON TOT_32.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 33 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_33 
                        ON TOT_33.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 34 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_34 
                        ON TOT_34.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 31 AND Y.PANGKAT_ID <=34  AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_GOL3 
                        ON TOT_GOL3.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 41 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_41 
                        ON TOT_41.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 42 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_42 
                        ON TOT_42.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE Y.PANGKAT_ID = 43 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_43 
                        ON TOT_43.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 44 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_44 
                        ON TOT_44.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 41 AND Y.PANGKAT_ID <=45  AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_GOL4 
                        ON TOT_GOL4.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X  LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE  X.TIPE_PEGAWAI_ID LIKE '2%') TOT 
                        ON TOT.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 11 AND X.TIPE_PEGAWAI_ID ='12') TOT_11_STAF 
                        ON TOT_11_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 12 AND X.TIPE_PEGAWAI_ID ='12') TOT_12_STAF 
                        ON TOT_12_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 13 AND X.TIPE_PEGAWAI_ID ='12') TOT_13_STAF 
                        ON TOT_13_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                         LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 14 AND X.TIPE_PEGAWAI_ID ='12') TOT_14_STAF 
                        ON TOT_14_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 11 AND Y.PANGKAT_ID <=14  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF1 
                        ON TOT_STAF1.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.TIPE_PEGAWAI_ID ='12') TOT_21_STAF 
                        ON TOT_21_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.TIPE_PEGAWAI_ID ='12') TOT_22_STAF  
                        ON TOT_22_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.TIPE_PEGAWAI_ID ='12') TOT_23_STAF  
                        ON TOT_23_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                         LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 24 AND X.TIPE_PEGAWAI_ID ='12') TOT_24_STAF  
                        ON TOT_24_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 21 AND Y.PANGKAT_ID <=24  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF2 
                        ON TOT_STAF2.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.TIPE_PEGAWAI_ID ='12') TOT_31_STAF  
                        ON TOT_31_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.TIPE_PEGAWAI_ID ='12') TOT_32_STAF  
                        ON TOT_32_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 33 AND X.TIPE_PEGAWAI_ID ='12') TOT_33_STAF  
                        ON TOT_33_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 34 AND X.TIPE_PEGAWAI_ID ='12') TOT_34_STAF  
                        ON TOT_34_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 31 AND Y.PANGKAT_ID <=34  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF3 
                        ON TOT_STAF3.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 41 AND X.TIPE_PEGAWAI_ID = '12') TOT_41_STAF 
                        ON TOT_41_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 42 AND X.TIPE_PEGAWAI_ID ='12') TOT_42_STAF 
                        ON TOT_42_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 43 AND X.TIPE_PEGAWAI_ID ='12') TOT_43_STAF 
                        ON TOT_43_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 44 AND X.TIPE_PEGAWAI_ID = '12') TOT_44_STAF 
                        ON TOT_44_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 41 AND Y.PANGKAT_ID <=45  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF4 
                        ON TOT_STAF4.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X  LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE  X.TIPE_PEGAWAI_ID = '12') TOT_STAF 
                        ON TOT_STAF.PEGAWAI_ID = B.PEGAWAI_ID
						WHERE 1=1 AND B.STATUS_PEGAWAI IN(1, 2) AND A.SATKER_ID IN ('010101','010102','010103','010201','010202','010203','010301','010302','010303','010304')
					GROUP BY A.SATKER_ID, A.NAMA
			UNION ALL
			SELECT A.SATKER_ID, A.NAMA, COUNT(TOT_21.PEGAWAI_ID) AS TOT_21, COUNT(TOT_22.PEGAWAI_ID) AS TOT_22, COUNT(TOT_23.PEGAWAI_ID) AS TOT_23, COUNT(TOT_24.PEGAWAI_ID) AS TOT_24, COUNT(TOT_GOL2.PEGAWAI_ID) AS TOT_GOL2
					  , COUNT(TOT_31.PEGAWAI_ID) AS TOT_31, COUNT(TOT_32.PEGAWAI_ID) AS TOT_32, COUNT(TOT_33.PEGAWAI_ID) AS TOT_33, COUNT(TOT_34.PEGAWAI_ID) AS TOT_34, COUNT(TOT_GOL3.PEGAWAI_ID) AS TOT_GOL3
					  , COUNT(TOT_41.PEGAWAI_ID) AS TOT_41, COUNT(TOT_42.PEGAWAI_ID) AS TOT_42, COUNT(TOT_43.PEGAWAI_ID) AS TOT_43, COUNT(TOT_44.PEGAWAI_ID) AS TOT_44, COUNT(TOT_GOL4.PEGAWAI_ID) AS TOT_GOL4,  COUNT(TOT.PEGAWAI_ID) AS TOT 
					  , COUNT(TOT_11_STAF.PEGAWAI_ID) AS TOT_11_STAF, COUNT(TOT_12_STAF.PEGAWAI_ID) AS TOT_12_STAF, COUNT(TOT_13_STAF.PEGAWAI_ID) AS TOT_13_STAF, COUNT(TOT_14_STAF.PEGAWAI_ID) AS TOT_14_STAF, COUNT(TOT_STAF1.PEGAWAI_ID) AS TOT_STAF1        
					  , COUNT(TOT_21_STAF.PEGAWAI_ID) AS TOT_21_STAF, COUNT(TOT_22_STAF.PEGAWAI_ID) AS TOT_22_STAF, COUNT(TOT_23_STAF.PEGAWAI_ID) AS TOT_23_STAF, COUNT(TOT_24_STAF.PEGAWAI_ID) AS TOT_24_STAF, COUNT(TOT_STAF2.PEGAWAI_ID) AS TOT_STAF2
					  , COUNT(TOT_31_STAF.PEGAWAI_ID) AS TOT_31_STAF, COUNT(TOT_32_STAF.PEGAWAI_ID) AS TOT_32_STAF, COUNT(TOT_33_STAF.PEGAWAI_ID) AS TOT_33_STAF, COUNT(TOT_34_STAF.PEGAWAI_ID) AS TOT_34_STAF, COUNT(TOT_STAF3.PEGAWAI_ID) AS TOT_STAF3
					  , COUNT(TOT_41_STAF.PEGAWAI_ID) AS TOT_41_STAF, COUNT(TOT_42_STAF.PEGAWAI_ID) AS TOT_42_STAF, COUNT(TOT_43_STAF.PEGAWAI_ID) AS TOT_43_STAF, COUNT(TOT_44_STAF.PEGAWAI_ID) AS TOT_44_STAF, COUNT(TOT_STAF4.PEGAWAI_ID) AS TOT_STAF4,  COUNT(TOT_STAF.PEGAWAI_ID) AS TOT_STAF
						FROM SATKER A
                        LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_21 
                        ON TOT_21.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_22 
                        ON TOT_22.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.TIPE_PEGAWAI_ID LIKE '2%' ) TOT_23 
                        ON TOT_23.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 24 AND X.TIPE_PEGAWAI_ID LIKE '2%' ) TOT_24 
                        ON TOT_24.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 21 AND Y.PANGKAT_ID <=24  AND X.TIPE_PEGAWAI_ID LIKE '2%' ) TOT_GOL2 
                        ON TOT_GOL2.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_31 
                        ON TOT_31.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_32 
                        ON TOT_32.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 33 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_33 
                        ON TOT_33.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 34 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_34 
                        ON TOT_34.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 31 AND Y.PANGKAT_ID <=34  AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_GOL3 
                        ON TOT_GOL3.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 41 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_41 
                        ON TOT_41.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 42 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_42 
                        ON TOT_42.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID  WHERE Y.PANGKAT_ID = 43 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_43 
                        ON TOT_43.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 44 AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_44 
                        ON TOT_44.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 41 AND Y.PANGKAT_ID <=45  AND X.TIPE_PEGAWAI_ID LIKE '2%') TOT_GOL4 
                        ON TOT_GOL4.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X  LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE  X.TIPE_PEGAWAI_ID LIKE '2%') TOT 
                        ON TOT.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 11 AND X.TIPE_PEGAWAI_ID ='12') TOT_11_STAF 
                        ON TOT_11_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 12 AND X.TIPE_PEGAWAI_ID ='12') TOT_12_STAF 
                        ON TOT_12_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 13 AND X.TIPE_PEGAWAI_ID ='12') TOT_13_STAF 
                        ON TOT_13_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                         LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 14 AND X.TIPE_PEGAWAI_ID ='12') TOT_14_STAF 
                        ON TOT_14_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 11 AND Y.PANGKAT_ID <=14  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF1 
                        ON TOT_STAF1.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 21 AND X.TIPE_PEGAWAI_ID ='12') TOT_21_STAF 
                        ON TOT_21_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 22 AND X.TIPE_PEGAWAI_ID ='12') TOT_22_STAF  
                        ON TOT_22_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 23 AND X.TIPE_PEGAWAI_ID ='12') TOT_23_STAF  
                        ON TOT_23_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                         LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 24 AND X.TIPE_PEGAWAI_ID ='12') TOT_24_STAF  
                        ON TOT_24_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 21 AND Y.PANGKAT_ID <=24  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF2 
                        ON TOT_STAF2.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 31 AND X.TIPE_PEGAWAI_ID ='12') TOT_31_STAF  
                        ON TOT_31_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 32 AND X.TIPE_PEGAWAI_ID ='12') TOT_32_STAF  
                        ON TOT_32_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 33 AND X.TIPE_PEGAWAI_ID ='12') TOT_33_STAF  
                        ON TOT_33_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 34 AND X.TIPE_PEGAWAI_ID ='12') TOT_34_STAF  
                        ON TOT_34_STAF .PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 31 AND Y.PANGKAT_ID <=34  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF3 
                        ON TOT_STAF3.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 41 AND X.TIPE_PEGAWAI_ID = '12') TOT_41_STAF 
                        ON TOT_41_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 42 AND X.TIPE_PEGAWAI_ID ='12') TOT_42_STAF 
                        ON TOT_42_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 43 AND X.TIPE_PEGAWAI_ID ='12') TOT_43_STAF 
                        ON TOT_43_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID = 44 AND X.TIPE_PEGAWAI_ID = '12') TOT_44_STAF 
                        ON TOT_44_STAF.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE Y.PANGKAT_ID >= 41 AND Y.PANGKAT_ID <=45  AND X.TIPE_PEGAWAI_ID ='12') TOT_STAF4 
                        ON TOT_STAF4.PEGAWAI_ID = B.PEGAWAI_ID
                        LEFT JOIN
                        (SELECT X.PEGAWAI_ID FROM PEGAWAI X  LEFT JOIN PANGKAT_TERAKHIR Y ON X.PEGAWAI_ID = Y.PEGAWAI_ID WHERE  X.TIPE_PEGAWAI_ID = '12') TOT_STAF 
                        ON TOT_STAF.PEGAWAI_ID = B.PEGAWAI_ID
					WHERE 1=1 AND B.STATUS_PEGAWAI IN(1, 2) AND A.SATKER_ID_PARENT = '0' AND A.SATKER_ID NOT IN ('01')
					GROUP BY A.SATKER_ID, A.NAMA
        ) A
		WHERE 1=1
		"; 
		$str .= $statement." ORDER BY A.SATKER_ID";
		$this->query = $str;
		
				
		return $this->selectLimit($str,-1,-1); 
    }

    function selectByParamsReportPensiunAll($paramsArray=array(),$limit=-1,$from=-1, $statement_satker='', $tipe="", $tahun="")
	{
		if($tipe == ""){}
		else
		{
			if($tipe == 1)
			{
				$awal= 1;
				$akhir= 6;
			}
			else
			{
				$awal= 7;
				$akhir= 12;
			}
		}
		
		$str = "
				SELECT SATKER_ID, NAMA, 
				TOT_11, TOT_12, TOT_13, TOT_14, TOT_GOL1, TOT_21, TOT_22, TOT_23, TOT_24, TOT_GOL2,
				TOT_31, TOT_32, TOT_33, TOT_34, TOT_GOL3, TOT_41, TOT_42, TOT_43, TOT_44, TOT_GOL4,
				TOT_L , TOT_P, TOT, TOT_KW, TOT_BL, TOT_JD, TOT_DD,
				JAN, FEB, MAR, APR, MEI, JUN, JUL, AUG, SEPT, OKT, NOV, DES
				FROM
				(
				SELECT A.SATKER_ID, A.NAMA, 
				COUNT(TOT_11.PEGAWAI_ID) AS TOT_11, COUNT(TOT_12.PEGAWAI_ID) AS TOT_12, COUNT(TOT_13.PEGAWAI_ID) AS TOT_13, COUNT(TOT_14.PEGAWAI_ID) AS TOT_14,
				COUNT(TOT_11.PEGAWAI_ID) + COUNT(TOT_12.PEGAWAI_ID) + COUNT(TOT_13.PEGAWAI_ID) + COUNT(TOT_14.PEGAWAI_ID) AS TOT_GOL1,
				COUNT(TOT_21.PEGAWAI_ID) AS TOT_21, COUNT(TOT_22.PEGAWAI_ID) AS TOT_22, COUNT(TOT_23.PEGAWAI_ID) AS TOT_23, COUNT(TOT_24.PEGAWAI_ID) AS TOT_24,
				COUNT(TOT_21.PEGAWAI_ID) + COUNT(TOT_22.PEGAWAI_ID) + COUNT(TOT_23.PEGAWAI_ID) + COUNT(TOT_24.PEGAWAI_ID) AS TOT_GOL2,
				COUNT(TOT_31.PEGAWAI_ID) AS TOT_31, COUNT(TOT_32.PEGAWAI_ID) AS TOT_32, COUNT(TOT_33.PEGAWAI_ID) AS TOT_33, COUNT(TOT_34.PEGAWAI_ID) AS TOT_34,
				COUNT(TOT_31.PEGAWAI_ID) + COUNT(TOT_32.PEGAWAI_ID) + COUNT(TOT_33.PEGAWAI_ID) + COUNT(TOT_34.PEGAWAI_ID) AS TOT_GOL3,
				COUNT(TOT_41.PEGAWAI_ID) AS TOT_41, COUNT(TOT_42.PEGAWAI_ID) AS TOT_42, COUNT(TOT_43.PEGAWAI_ID) AS TOT_43, COUNT(TOT_44.PEGAWAI_ID) AS TOT_44,
				COUNT(TOT_41.PEGAWAI_ID) + COUNT(TOT_42.PEGAWAI_ID) + COUNT(TOT_43.PEGAWAI_ID) + COUNT(TOT_44.PEGAWAI_ID) AS TOT_GOL4,
				COUNT(TOT_L.PEGAWAI_ID) AS TOT_L , COUNT(TOT_P.PEGAWAI_ID) AS TOT_P,
				COUNT(TOT_L.PEGAWAI_ID) + COUNT(TOT_P.PEGAWAI_ID) AS TOT,
				COUNT(TOT_KW.PEGAWAI_ID) AS TOT_KW, COUNT(TOT_BL.PEGAWAI_ID) AS TOT_BL, COUNT(TOT_JD.PEGAWAI_ID) AS TOT_JD,  COUNT(TOT_DD.PEGAWAI_ID) AS TOT_DD,
				COUNT(TOT_JAN.PEGAWAI_ID) AS JAN, COUNT(TOT_FEB.PEGAWAI_ID) AS FEB, COUNT(TOT_MAR.PEGAWAI_ID) AS MAR, COUNT(TOT_APR.PEGAWAI_ID) AS APR, COUNT(TOT_MEI.PEGAWAI_ID) AS MEI, COUNT(TOT_JUN.PEGAWAI_ID) AS JUN, COUNT(TOT_JUL.PEGAWAI_ID) AS JUL, COUNT(TOT_AGU.PEGAWAI_ID) AS AUG,  COUNT(TOT_SEP.PEGAWAI_ID) AS SEPT, COUNT(TOT_OKT.PEGAWAI_ID) AS OKT, COUNT(TOT_NOV.PEGAWAI_ID) AS NOV, COUNT(TOT_DES.PEGAWAI_ID) AS DES
				FROM SATKER A
				LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 11) TOT_11 ON TOT_11.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 12) TOT_12 ON TOT_12.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 13) TOT_13 ON TOT_13.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 14) TOT_14 ON TOT_14.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 21) TOT_21 ON TOT_21.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 22) TOT_22 ON TOT_22.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 23) TOT_23 ON TOT_23.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 24) TOT_24 ON TOT_24.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 31) TOT_31 ON TOT_31.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 32) TOT_32 ON TOT_32.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 33) TOT_33 ON TOT_33.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 34) TOT_34 ON TOT_34.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 41) TOT_41 ON TOT_41.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 42) TOT_42 ON TOT_42.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 43) TOT_43 ON TOT_43.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 44) TOT_44 ON TOT_44.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.JENIS_KELAMIN = 'L') TOT_L ON TOT_L.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.JENIS_KELAMIN = 'P') TOT_P ON TOT_P.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 1) TOT_BL ON TOT_BL.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 2) TOT_KW ON TOT_KW.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 3) TOT_JD ON TOT_JD.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 4) TOT_DD ON TOT_DD.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 1) TOT_JAN ON B.PEGAWAI_ID = TOT_JAN.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 2) TOT_FEB ON B.PEGAWAI_ID = TOT_FEB.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 3) TOT_MAR ON B.PEGAWAI_ID = TOT_MAR.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 4) TOT_APR ON B.PEGAWAI_ID = TOT_APR.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 5) TOT_MEI ON B.PEGAWAI_ID = TOT_MEI.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 6) TOT_JUN ON B.PEGAWAI_ID = TOT_JUN.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 7) TOT_JUL ON B.PEGAWAI_ID = TOT_JUL.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 8) TOT_AGU ON B.PEGAWAI_ID = TOT_AGU.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 9) TOT_SEP ON B.PEGAWAI_ID = TOT_SEP.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 10) TOT_OKT ON B.PEGAWAI_ID = TOT_OKT.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 11) TOT_NOV ON B.PEGAWAI_ID = TOT_NOV.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 12) TOT_DES ON B.PEGAWAI_ID = TOT_DES.PEGAWAI_ID
				WHERE 1=1 AND A.SATKER_ID = '01' AND LENGTH(B.SATKER_ID) <= 4
				GROUP BY A.SATKER_ID, A.NAMA
				UNION ALL
				SELECT A.SATKER_ID, A.NAMA, 
				COUNT(TOT_11.PEGAWAI_ID) AS TOT_11, COUNT(TOT_12.PEGAWAI_ID) AS TOT_12, COUNT(TOT_13.PEGAWAI_ID) AS TOT_13, COUNT(TOT_14.PEGAWAI_ID) AS TOT_14,
				COUNT(TOT_11.PEGAWAI_ID) + COUNT(TOT_12.PEGAWAI_ID) + COUNT(TOT_13.PEGAWAI_ID) + COUNT(TOT_14.PEGAWAI_ID) AS TOT_GOL1,
				COUNT(TOT_21.PEGAWAI_ID) AS TOT_21, COUNT(TOT_22.PEGAWAI_ID) AS TOT_22, COUNT(TOT_23.PEGAWAI_ID) AS TOT_23, COUNT(TOT_24.PEGAWAI_ID) AS TOT_24,
				COUNT(TOT_21.PEGAWAI_ID) + COUNT(TOT_22.PEGAWAI_ID) + COUNT(TOT_23.PEGAWAI_ID) + COUNT(TOT_24.PEGAWAI_ID) AS TOT_GOL2,
				COUNT(TOT_31.PEGAWAI_ID) AS TOT_31, COUNT(TOT_32.PEGAWAI_ID) AS TOT_32, COUNT(TOT_33.PEGAWAI_ID) AS TOT_33, COUNT(TOT_34.PEGAWAI_ID) AS TOT_34,
				COUNT(TOT_31.PEGAWAI_ID) + COUNT(TOT_32.PEGAWAI_ID) + COUNT(TOT_33.PEGAWAI_ID) + COUNT(TOT_34.PEGAWAI_ID) AS TOT_GOL3,
				COUNT(TOT_41.PEGAWAI_ID) AS TOT_41, COUNT(TOT_42.PEGAWAI_ID) AS TOT_42, COUNT(TOT_43.PEGAWAI_ID) AS TOT_43, COUNT(TOT_44.PEGAWAI_ID) AS TOT_44,
				COUNT(TOT_41.PEGAWAI_ID) + COUNT(TOT_42.PEGAWAI_ID) + COUNT(TOT_43.PEGAWAI_ID) + COUNT(TOT_44.PEGAWAI_ID) AS TOT_GOL4,
				COUNT(TOT_L.PEGAWAI_ID) AS TOT_L , COUNT(TOT_P.PEGAWAI_ID) AS TOT_P,
				COUNT(TOT_L.PEGAWAI_ID) + COUNT(TOT_P.PEGAWAI_ID) AS TOT,
				COUNT(TOT_KW.PEGAWAI_ID) AS TOT_KW, COUNT(TOT_BL.PEGAWAI_ID) AS TOT_BL, COUNT(TOT_JD.PEGAWAI_ID) AS TOT_JD,  COUNT(TOT_DD.PEGAWAI_ID) AS TOT_DD,
				COUNT(TOT_JAN.PEGAWAI_ID) AS JAN, COUNT(TOT_FEB.PEGAWAI_ID) AS FEB, COUNT(TOT_MAR.PEGAWAI_ID) AS MAR, COUNT(TOT_APR.PEGAWAI_ID) AS APR, COUNT(TOT_MEI.PEGAWAI_ID) AS MEI, COUNT(TOT_JUN.PEGAWAI_ID) AS JUN, COUNT(TOT_JUL.PEGAWAI_ID) AS JUL, COUNT(TOT_AGU.PEGAWAI_ID) AS AUG,  COUNT(TOT_SEP.PEGAWAI_ID) AS SEPT, COUNT(TOT_OKT.PEGAWAI_ID) AS OKT, COUNT(TOT_NOV.PEGAWAI_ID) AS NOV, COUNT(TOT_DES.PEGAWAI_ID) AS DES
				FROM SATKER A
				LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 11) TOT_11 ON TOT_11.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 12) TOT_12 ON TOT_12.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 13) TOT_13 ON TOT_13.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 14) TOT_14 ON TOT_14.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 21) TOT_21 ON TOT_21.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 22) TOT_22 ON TOT_22.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 23) TOT_23 ON TOT_23.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 24) TOT_24 ON TOT_24.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 31) TOT_31 ON TOT_31.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 32) TOT_32 ON TOT_32.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 33) TOT_33 ON TOT_33.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 34) TOT_34 ON TOT_34.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 41) TOT_41 ON TOT_41.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 42) TOT_42 ON TOT_42.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 43) TOT_43 ON TOT_43.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 44) TOT_44 ON TOT_44.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.JENIS_KELAMIN = 'L') TOT_L ON TOT_L.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.JENIS_KELAMIN = 'P') TOT_P ON TOT_P.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 1) TOT_BL ON TOT_BL.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 2) TOT_KW ON TOT_KW.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 3) TOT_JD ON TOT_JD.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 4) TOT_DD ON TOT_DD.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 1) TOT_JAN ON B.PEGAWAI_ID = TOT_JAN.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 2) TOT_FEB ON B.PEGAWAI_ID = TOT_FEB.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 3) TOT_MAR ON B.PEGAWAI_ID = TOT_MAR.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 4) TOT_APR ON B.PEGAWAI_ID = TOT_APR.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 5) TOT_MEI ON B.PEGAWAI_ID = TOT_MEI.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 6) TOT_JUN ON B.PEGAWAI_ID = TOT_JUN.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 7) TOT_JUL ON B.PEGAWAI_ID = TOT_JUL.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 8) TOT_AGU ON B.PEGAWAI_ID = TOT_AGU.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 9) TOT_SEP ON B.PEGAWAI_ID = TOT_SEP.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 10) TOT_OKT ON B.PEGAWAI_ID = TOT_OKT.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 11) TOT_NOV ON B.PEGAWAI_ID = TOT_NOV.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 12) TOT_DES ON B.PEGAWAI_ID = TOT_DES.PEGAWAI_ID
				WHERE 1=1 AND A.SATKER_ID IN ('010101','010102','010103','010201','010202','010203','010301','010302','010303','010304')
				GROUP BY A.SATKER_ID, A.NAMA
				UNION ALL
				SELECT A.SATKER_ID, A.NAMA, 
				COUNT(TOT_11.PEGAWAI_ID) AS TOT_11, COUNT(TOT_12.PEGAWAI_ID) AS TOT_12, COUNT(TOT_13.PEGAWAI_ID) AS TOT_13, COUNT(TOT_14.PEGAWAI_ID) AS TOT_14,
				COUNT(TOT_11.PEGAWAI_ID) + COUNT(TOT_12.PEGAWAI_ID) + COUNT(TOT_13.PEGAWAI_ID) + COUNT(TOT_14.PEGAWAI_ID) AS TOT_GOL1,
				COUNT(TOT_21.PEGAWAI_ID) AS TOT_21, COUNT(TOT_22.PEGAWAI_ID) AS TOT_22, COUNT(TOT_23.PEGAWAI_ID) AS TOT_23, COUNT(TOT_24.PEGAWAI_ID) AS TOT_24,
				COUNT(TOT_21.PEGAWAI_ID) + COUNT(TOT_22.PEGAWAI_ID) + COUNT(TOT_23.PEGAWAI_ID) + COUNT(TOT_24.PEGAWAI_ID) AS TOT_GOL2,
				COUNT(TOT_31.PEGAWAI_ID) AS TOT_31, COUNT(TOT_32.PEGAWAI_ID) AS TOT_32, COUNT(TOT_33.PEGAWAI_ID) AS TOT_33, COUNT(TOT_34.PEGAWAI_ID) AS TOT_34,
				COUNT(TOT_31.PEGAWAI_ID) + COUNT(TOT_32.PEGAWAI_ID) + COUNT(TOT_33.PEGAWAI_ID) + COUNT(TOT_34.PEGAWAI_ID) AS TOT_GOL3,
				COUNT(TOT_41.PEGAWAI_ID) AS TOT_41, COUNT(TOT_42.PEGAWAI_ID) AS TOT_42, COUNT(TOT_43.PEGAWAI_ID) AS TOT_43, COUNT(TOT_44.PEGAWAI_ID) AS TOT_44,
				COUNT(TOT_41.PEGAWAI_ID) + COUNT(TOT_42.PEGAWAI_ID) + COUNT(TOT_43.PEGAWAI_ID) + COUNT(TOT_44.PEGAWAI_ID) AS TOT_GOL4,
				COUNT(TOT_L.PEGAWAI_ID) AS TOT_L , COUNT(TOT_P.PEGAWAI_ID) AS TOT_P,
				COUNT(TOT_L.PEGAWAI_ID) + COUNT(TOT_P.PEGAWAI_ID) AS TOT,
				COUNT(TOT_KW.PEGAWAI_ID) AS TOT_KW, COUNT(TOT_BL.PEGAWAI_ID) AS TOT_BL, COUNT(TOT_JD.PEGAWAI_ID) AS TOT_JD,  COUNT(TOT_DD.PEGAWAI_ID) AS TOT_DD,
				COUNT(TOT_JAN.PEGAWAI_ID) AS JAN, COUNT(TOT_FEB.PEGAWAI_ID) AS FEB, COUNT(TOT_MAR.PEGAWAI_ID) AS MAR, COUNT(TOT_APR.PEGAWAI_ID) AS APR, COUNT(TOT_MEI.PEGAWAI_ID) AS MEI, COUNT(TOT_JUN.PEGAWAI_ID) AS JUN, COUNT(TOT_JUL.PEGAWAI_ID) AS JUL, COUNT(TOT_AGU.PEGAWAI_ID) AS AUG,  COUNT(TOT_SEP.PEGAWAI_ID) AS SEPT, COUNT(TOT_OKT.PEGAWAI_ID) AS OKT, COUNT(TOT_NOV.PEGAWAI_ID) AS NOV, COUNT(TOT_DES.PEGAWAI_ID) AS DES
				FROM SATKER A
				LEFT JOIN PEGAWAI B ON B.SATKER_ID LIKE A.SATKER_ID || '%'
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 11) TOT_11 ON TOT_11.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 12) TOT_12 ON TOT_12.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 13) TOT_13 ON TOT_13.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 14) TOT_14 ON TOT_14.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 21) TOT_21 ON TOT_21.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 22) TOT_22 ON TOT_22.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 23) TOT_23 ON TOT_23.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 24) TOT_24 ON TOT_24.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 31) TOT_31 ON TOT_31.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 32) TOT_32 ON TOT_32.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 33) TOT_33 ON TOT_33.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 34) TOT_34 ON TOT_34.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 41) TOT_41 ON TOT_41.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 42) TOT_42 ON TOT_42.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 43) TOT_43 ON TOT_43.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PANGKAT_TERAKHIR X  WHERE X.PANGKAT_ID = 44) TOT_44 ON TOT_44.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.JENIS_KELAMIN = 'L') TOT_L ON TOT_L.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.JENIS_KELAMIN = 'P') TOT_P ON TOT_P.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 1) TOT_BL ON TOT_BL.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 2) TOT_KW ON TOT_KW.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 3) TOT_JD ON TOT_JD.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN(SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_KAWIN = 4) TOT_DD ON TOT_DD.PEGAWAI_ID = B.PEGAWAI_ID AND B.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM B.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM B.TANGGAL_PENSIUN) BETWEEN  ".$awal." AND ".$akhir."
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 1) TOT_JAN ON B.PEGAWAI_ID = TOT_JAN.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 2) TOT_FEB ON B.PEGAWAI_ID = TOT_FEB.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 3) TOT_MAR ON B.PEGAWAI_ID = TOT_MAR.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 4) TOT_APR ON B.PEGAWAI_ID = TOT_APR.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 5) TOT_MEI ON B.PEGAWAI_ID = TOT_MEI.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 6) TOT_JUN ON B.PEGAWAI_ID = TOT_JUN.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 7) TOT_JUL ON B.PEGAWAI_ID = TOT_JUL.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 8) TOT_AGU ON B.PEGAWAI_ID = TOT_AGU.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 9) TOT_SEP ON B.PEGAWAI_ID = TOT_SEP.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 10) TOT_OKT ON B.PEGAWAI_ID = TOT_OKT.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 11) TOT_NOV ON B.PEGAWAI_ID = TOT_NOV.PEGAWAI_ID
				LEFT JOIN (SELECT X.PEGAWAI_ID FROM PEGAWAI X WHERE X.STATUS_PEGAWAI = 3 AND EXTRACT(YEAR FROM X.TANGGAL_PENSIUN) = '".$tahun."' AND EXTRACT(MONTH FROM X.TANGGAL_PENSIUN) = 12) TOT_DES ON B.PEGAWAI_ID = TOT_DES.PEGAWAI_ID
				WHERE 1=1 AND A.SATKER_ID_PARENT = '0' AND A.SATKER_ID NOT IN ('01')
				GROUP BY A.SATKER_ID, A.NAMA
				) A
				WHERE 1=1
		".$statement_satker; 
		
		$this->query = $str;
		//echo $str;
		return $this->selectLimit($str,$limit,$from);
    }
	

   

}